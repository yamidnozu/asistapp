00:00 +0: loading C:/Proyectos/DemoLife/integration_test/main_e2e_test.dart
Building Windows application...                                    29,4s
âˆš Built build\windows\x64\runner\Debug\asistapp.exe
00:00 +0: ğŸš€ FLUJO E2E TRANSACCIONAL - MICRO-UNIVERSO AISLADO

======================================================================
ğŸ¯ INICIANDO TEST E2E TRANSACCIONAL - MICRO-UNIVERSO AISLADO
   Timestamp Ãºnico: 95584360
   DÃ­a de hoy (UTC): Viernes (5)
   Hora actual (UTC): 0:46
   Horario a crear: 00:00 - 01:00

   ğŸ“¦ DATOS ÃšNICOS A CREAR:
   â€¢ InstituciÃ³n: Instituto 95584360
   â€¢ Admin: admin_95584360@test.com
   â€¢ Profesor: profe_95584360@test.com
   â€¢ Estudiante: estu_95584360@test.com
   â€¢ PerÃ­odo: Periodo 95584360
   â€¢ Materia: Materia 95584360
   â€¢ Grupo: Grupo 95584360

   âš ï¸ MODO ESTRICTO: Sin fallbacks al seed
======================================================================

AppConfig: No se pudo cargar .env: Instance of 'FileNotFoundError'
AppConfig: Rutas intentadas para .env (muestra hasta 30):
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\Debug\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\.env
  - C:\Proyectos\DemoLife\build\windows\x64\.env
  - C:\Proyectos\DemoLife\build\windows\.env
  - C:\Proyectos\DemoLife\build\.env
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\.env
  - C:\Proyectos\DemoLife\build\windows\x64\.env
  - C:\Proyectos\DemoLife\build\windows\.env
  - C:\Proyectos\DemoLife\build\.env
  - C:\Proyectos\DemoLife\.env
AppConfig: Usando configuraciÃ³n por defecto
  - API_BASE_URL: http://192.168.20.22:3000
  - ENVIRONMENT: development
  - Plataforma: windows

ğŸ“ FASE 1: GÃ‰NESIS (Super Admin crea InstituciÃ³n + Admin)

AuthService.login - URL: http://192.168.20.22:3000/auth/login
AuthService.login - Config Base URL: http://192.168.20.22:3000
ğŸ“¤ POST /auth/login
ğŸ“¡ HTTP 200 /auth/login
   Status: 200
   Body: {"success":true,"data":{"accessToken":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjQ4MmE3ZGI1LTRkZTctNGVkZi05MDhlLTc2MDFiYTQ4ODYyNiIsInJvbCI6InN1cGVyX2FkbWluIiwiZW1haWwiOiJzdXBlcmFkbWluQGFzaXN0YXBwLmNvbSIsInRva2VuVmVyc2lvbiI6MSwiaWF0IjoxNzY0ODk1NjI4LCJleHAiOjE3NjQ5ODIwMjh9.lBIuOBdXqQpanBsicZVIde4XSBmlK6SdqzXrokYPNB4","refreshToken":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjQ4MmE3ZGI1LTRkZTctNGVkZi05MDhlLTc2MDFiYTQ4ODYyNiIsInJvbCI6InN1cGVyX2FkbWluIiwiZW1haWwiOiJzdXBlcmFkbWluQGFzaXN0YXBwLmNvbSIsInRva2VuVmVyc2lvbiI6MSwianRpIjoiMGU0MzQ5NDAtMDcwOS00NDBkLThkM2MtMDllNTgzZDZmMzlmIiwiaWF0IjoxNzY0ODk1NjI4LCJleHAiOjE3NjU1MDA0Mjh9.IppZcOz_ZX7hvRXiagThJUr-Io8kJZZudEs78pN7Iac","expiresIn":24,"usuario":{"id":"482a7db5-4de7-4edf-908e-7601ba488626","nombres":"Super","apellidos":"Admin","rol":"super_admin","instituciones":[]}}}
========================================
ğŸ“¤ GET /auth/institutions
ğŸ“¡ HTTP 200 /auth/institutions
Super Admin: No requiere selecciÃ³n de instituciÃ³n (acceso global)
Login exitoso, AuthWrapper manejarÃ¡ la navegaciÃ³n
UserProvider: Iniciando carga de usuarios...
VersiÃ³n obtenida del pubspec: 1.0.11
GET /usuarios - Status: 200
InstitutionProvider: Iniciando carga de instituciones...
GET /instituciones - Status: 200
GET /instituciones - data[0]: {id: d21c812d-d5d7-4924-b72a-86a5d1c3fec2, nombre: Instituto 93197360, direccion: Calle Test 123, telefono: 555-93197360, email: test_93197360@test.edu, activa: true, createdAt: 2025-12-05T00:08:13.093Z, updatedAt: 2025-12-05T00:08:13.093Z}
InstitutionProvider: Estado cambiado a loaded
  âœ… [FASE 1] 1.1 Login Super Admin
Cargando instituciones con token: eyJhbGciOiJIUzI1NiIs...
InstitutionProvider: Iniciando carga de instituciones...
GET /instituciones - Status: 200
GET /instituciones - data[0]: {id: d21c812d-d5d7-4924-b72a-86a5d1c3fec2, nombre: Instituto 93197360, direccion: Calle Test 123, telefono: 555-93197360, email: test_93197360@test.edu, activa: true, createdAt: 2025-12-05T00:08:13.093Z, updatedAt: 2025-12-05T00:08:13.093Z}
InstitutionProvider: Estado cambiado a loaded
Instituciones cargadas: 6
Estado del provider: isLoading=false, hasError=false
  âœ… [FASE 1] 1.2 Navegar a Instituciones
    ğŸ“± [NOTIFICACIONES] Configurando notificaciones del micro-universo...
  âœ… [FASE 1] 1.3a SecciÃ³n Notificaciones visible
    ğŸ“± [NOTIFICACIONES] Encontrados 2 switches
    ğŸ“± [NOTIFICACIONES] Estado inicial switch notificaciones: false
  âœ… [FASE 1] 1.3b Activar notificaciones
    ğŸ“± [NOTIFICACIONES] Dropdowns encontrados: 2
  âœ… [FASE 1] 1.3c Seleccionar canal WhatsApp
  âœ… [FASE 1] 1.3d Seleccionar modo InstantÃ¡neo
    ğŸ“± [NOTIFICACIONES] Resumen configuraciÃ³n:
       â€¢ Activas: true
       â€¢ Canal: WHATSAPP
       â€¢ Modo: INSTANT
POST /instituciones - Status: 201
PUT http://192.168.20.22:3000/api/institutions/f89352f8-7a5b-4a52-8601-ce228f7212f7/notification-config - Status: 200
GET /instituciones/f89352f8-7a5b-4a52-8601-ce228f7212f7 - Status: 200
GET /instituciones/f89352f8-7a5b-4a52-8601-ce228f7212f7 - data: {id: f89352f8-7a5b-4a52-8601-ce228f7212f7, nombre: Instituto 95584360, direccion: Calle Test 123, telefono: 555-95584360, email: test_95584360@test.edu, activa: true, configuraciones: {notificacionesActivas: true, canalNotificacion: WHATSAPP, modoNotificacionAsistencia: INSTANT, horaDisparoNotificacion: null, umbralFaltas: 3}, createdAt: 2025-12-05T00:48:00.861Z, updatedAt: 2025-12-05T00:48:00.861Z}
InstitutionProvider: loadInstitutionById - fetched: Institution(id: f89352f8-7a5b-4a52-8601-ce228f7212f7, nombre: Instituto 95584360, activa: true)
  âœ… [FASE 1] 1.3 Crear InstituciÃ³n (Instituto 95584360)
Cargando usuarios (admin_institucion y super_admin) como super_admin...
UserProvider: Iniciando carga de usuarios...
GET /usuarios - Status: 200
  âœ… [FASE 1] 1.4 Navegar a gestiÃ³n de usuarios
    ğŸ“ [DEBUG] Iniciando creaciÃ³n de Admin InstituciÃ³n...
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
    ğŸ“ [DEBUG] SpeedDial tapado: true
    ğŸ“ [STEP 1] InformaciÃ³n de Cuenta
    ğŸ“ [STEP 1] TextFormFields encontrados: 6
    ğŸ“ [STEP 1] Campo email encontrado, llenando: admin_95584360@test.com
    ğŸ“ [STEP 1] Seleccionando instituciÃ³n: Instituto 95584360
       ğŸ“¦ [selectInstitutionFromModal] Iniciando para: Instituto 95584360
       ğŸ“¦ [selectInstitutionFromModal] Campo instituciÃ³n encontrado, haciendo tap...
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
       ğŸ“¦ [selectInstitutionFromModal] BottomSheets encontrados: 1
       ğŸ“¦ [selectInstitutionFromModal] CheckboxListTiles encontrados: 5
       ğŸ“¦ [selectInstitutionFromModal] Textos que contienen "Instituto 95584360": 1
       ğŸ“¦ [selectInstitutionFromModal] Encontrado! Haciendo tap...
       ğŸ“¦ [selectInstitutionFromModal] Botones "Confirmar selecciÃ³n": 1
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
       âœ… [selectInstitutionFromModal] Confirmado!
    ğŸ“ [STEP 1] InstituciÃ³n seleccionada: true
    ğŸ“ [STEP 1] Avanzando a Step 2...
    ğŸ“ [STEP 1] Botones formSaveButton encontrados: 2
ğŸ”” _onStepContinue CALLED! currentStep=0
ğŸ”” totalSteps=2
ğŸ”” stepState for step 0: FormState#218aa
ğŸ”” validation result: true
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
    ğŸ“ [STEP 2] InformaciÃ³n Personal
    ğŸ“ [STEP 2] TextFormFields ahora: 6
    ğŸ“ [STEP 2] Step widgets encontrados: 0
    ğŸ“ [STEP 2] Textos "Info Personal" encontrados: 1
    ğŸ“ [STEP 2] Campo nombres encontrado: true
    ğŸ“ [STEP 2] Campo apellidos encontrado: true
    ğŸ“ [STEP 2] Campo nombres encontrado por Key
    ğŸ“ [STEP 2] Texto ingresado en nombres: Admin 95584360
    ğŸ“ [STEP 2] Campo apellidos encontrado por Key
    ğŸ“ [STEP 2] Texto ingresado en apellidos: TestApellido
    ğŸ“ [STEP 2] Datos personales llenados
    ğŸ“ [STEP 2] Buscando botÃ³n de guardar (Crear)...
    ğŸ“ [STEP 2] Botones con texto "Crear" encontrados: 2
ğŸ”” _onStepContinue CALLED! currentStep=1
ğŸ”” totalSteps=2
ğŸ”” stepState for step 1: FormState#dfbfb
ğŸ”” validation result: true
    ğŸ“ [STEP 2] BotÃ³n "Crear" tapado (usando last), esperando respuesta del servidor...
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
POST /usuarios - Status: 201
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
    ğŸ“ [STEP 2] Textos "ContraseÃ±a" encontrados: 1
