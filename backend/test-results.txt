ğŸ” Verificando conexiÃ³n con el servidor...
âœ… Servidor conectado

ğŸš€ INICIANDO PRUEBAS EXHAUSTIVAS DE FLUJOS COMPLETOS - AsistApp Backend
========================================================================


ğŸ” ===== FLUJO 1: AUTENTICACIÃ“N Y SESIONES =====

ğŸ“± 1.1 LOGIN - Simulando login desde Flutter
ğŸ” Iniciando sesiÃ³n como ADMIN_INSTITUCION (admin@sanjose.edu)...
âŒ Error iniciando sesiÃ³n para ADMIN_INSTITUCION: {
  success: false,
  error: 'Credenciales invÃ¡lidas',
  code: 'AUTHENTICATION_ERROR'
}
ğŸ” Iniciando sesiÃ³n como PROFESOR (ana.lopez@sanjose.edu)...
âœ… SesiÃ³n iniciada para PROFESOR
   ğŸ‘¤ Usuario: Ana LÃ³pez
   ğŸ« InstituciÃ³n ID: undefined
ğŸ” Iniciando sesiÃ³n como ESTUDIANTE (juan.perez@sanjose.edu)...
âœ… SesiÃ³n iniciada para ESTUDIANTE
   ğŸ‘¤ Usuario: Juan PÃ©rez
   ğŸ« InstituciÃ³n ID: undefined

ğŸ“± 1.2 VERIFICACIÃ“N DE SESIÃ“N - App verifica token guardado

ğŸ§ª Verificar token Admin InstituciÃ³n
   GET /auth/verify
âŒ Status: 401 (esperado: 200)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ§ª Verificar token Profesor
   GET /auth/verify
âœ… Status: 200 (esperado: 200)
   âœ… Respuesta exitosa

ğŸ§ª Verificar token Estudiante
   GET /auth/verify
âœ… Status: 200 (esperado: 200)
   âœ… Respuesta exitosa

ğŸ“± 1.3 ACCESO SIN AUTENTICACIÃ“N - Usuario sin login

ğŸ§ª Verificar token sin autenticaciÃ³n (Sin autenticaciÃ³n)
   GET /auth/verify
âœ… Status: 401 (esperado: 401)

ğŸ§ª Acceder a datos sin token (Sin autenticaciÃ³n)
   GET /grupos
âœ… Status: 401 (esperado: 401)

ğŸ“± 1.4 LOGOUT - Usuario cierra sesiÃ³n
   ğŸ”„ Simulando logout - removiendo tokens...

ğŸ‘¨â€ğŸ« ===== FLUJO 2: GESTIÃ“N DE PROFESORES =====

ğŸ“± 2.1 LISTADO DE PROFESORES - Admin ve lista de profesores

ğŸ§ª Listar todos los profesores
   GET /institution-admin/profesores
âŒ Status: 401 (esperado: 200)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ§ª Listar profesores con paginaciÃ³n
   GET /institution-admin/profesores?page=1&limit=5
âŒ Status: 401 (esperado: 200)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ§ª Filtrar profesores activos
   GET /institution-admin/profesores?activo=true
âŒ Status: 401 (esperado: 200)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ§ª Buscar profesores por nombre
   GET /institution-admin/profesores?search=Juan
âŒ Status: 401 (esperado: 200)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ“± 2.2 CREAR PROFESOR - Admin crea nuevo profesor

ğŸ§ª Crear nuevo profesor
   POST /institution-admin/profesores
âŒ Status: 401 (esperado: 201)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ“± 2.8 ACCESO DENEGADO - Otros roles intentan gestionar profesores

ğŸ§ª Profesor intenta ver lista de profesores (debe fallar)
   GET /institution-admin/profesores
âœ… Status: 403 (esperado: 403)
   âš ï¸  Respuesta esperada con error: undefined

ğŸ§ª Estudiante intenta ver lista de profesores (debe fallar)
   GET /institution-admin/profesores
âœ… Status: 403 (esperado: 403)
   âš ï¸  Respuesta esperada con error: undefined

ğŸ« ===== FLUJO 3: GESTIÃ“N DE GRUPOS =====
âŒ Error obteniendo periodo acadÃ©mico: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ“± 3.1 LISTADO DE GRUPOS - Admin ve todos los grupos

ğŸ§ª Listar todos los grupos
   GET /grupos
âŒ Status: 401 (esperado: 200)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ§ª Listar grupos con paginaciÃ³n
   GET /grupos?page=1&limit=10
âŒ Status: 401 (esperado: 200)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ“± 3.2 CREAR GRUPO - Admin crea nuevo grupo

ğŸ§ª Crear nuevo grupo
   POST /grupos
âŒ Status: 401 (esperado: 201)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ“± 3.6 VALIDACIONES - Crear grupo con datos invÃ¡lidos

ğŸ§ª Crear grupo sin nombre (debe fallar)
   POST /grupos
âŒ Status: 401 (esperado: 400)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ§ª Crear grupo sin grado (debe fallar)
   POST /grupos
âŒ Status: 401 (esperado: 400)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ§ª Crear grupo sin periodoId (debe fallar)
   POST /grupos
âœ… Status: 400 (esperado: 400)
   âš ï¸  Respuesta esperada con error: undefined

ğŸ“± 3.7 ACCESO DENEGADO - Otros roles intentan gestionar grupos

ğŸ§ª Profesor intenta ver grupos (debe fallar)
   GET /grupos
âœ… Status: 403 (esperado: 403)
   âš ï¸  Respuesta esperada con error: undefined

ğŸ§ª Estudiante intenta ver grupos (debe fallar)
   GET /grupos
âœ… Status: 403 (esperado: 403)
   âš ï¸  Respuesta esperada con error: undefined

ğŸ“š ===== FLUJO 4: GESTIÃ“N DE MATERIAS =====

ğŸ“± 4.1 LISTADO DE MATERIAS - Admin ve todas las materias

ğŸ§ª Listar todas las materias
   GET /materias
âŒ Status: 401 (esperado: 200)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ§ª Listar materias con paginaciÃ³n
   GET /materias?page=1&limit=10
âŒ Status: 401 (esperado: 200)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ“± 4.2 CREAR MATERIA - Admin crea nueva materia

ğŸ§ª Crear nueva materia
   POST /materias
âŒ Status: 401 (esperado: 201)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ“± 4.6 VALIDACIONES - Crear materia con datos invÃ¡lidos

ğŸ§ª Crear materia sin nombre (debe fallar)
   POST /materias
âŒ Status: 401 (esperado: 400)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ“± 4.7 ACCESO DENEGADO - Otros roles intentan gestionar materias

ğŸ§ª Profesor intenta ver materias (debe fallar)
   GET /materias
âœ… Status: 403 (esperado: 403)
   âš ï¸  Respuesta esperada con error: undefined

ğŸ§ª Estudiante intenta ver materias (debe fallar)
   GET /materias
âœ… Status: 403 (esperado: 403)
   âš ï¸  Respuesta esperada con error: undefined

ğŸ“… ===== FLUJO 5: GESTIÃ“N DE HORARIOS =====

ğŸ“± 5.1 LISTADO DE HORARIOS - Admin ve todos los horarios

ğŸ§ª Listar todos los horarios
   GET /horarios
âŒ Status: 401 (esperado: 200)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ§ª Listar horarios con paginaciÃ³n
   GET /horarios?page=1&limit=10
âŒ Status: 401 (esperado: 200)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}
   âš ï¸  Error obteniendo entidades existentes para horario

ğŸ“± 5.6 VALIDACIONES - Crear horario con datos invÃ¡lidos

ğŸ§ª Crear horario con IDs invÃ¡lidos (debe fallar)
   POST /horarios
âŒ Status: 401 (esperado: 400)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ§ª Crear horario con dÃ­a de semana invÃ¡lido (debe fallar)
   POST /horarios
âŒ Status: 401 (esperado: 400)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ“± 5.7 ACCESO DENEGADO - Otros roles intentan gestionar horarios

ğŸ§ª Profesor intenta ver horarios (debe fallar)
   GET /horarios
âœ… Status: 403 (esperado: 403)
   âš ï¸  Respuesta esperada con error: undefined

ğŸ§ª Estudiante intenta ver horarios (debe fallar)
   GET /horarios
âœ… Status: 403 (esperado: 403)
   âš ï¸  Respuesta esperada con error: undefined

ğŸ‘¨â€ğŸ« ===== FLUJO 6: DASHBOARD DEL PROFESOR =====

ğŸ“± 6.1 CLASES DEL DÃA - Profesor ve sus clases de hoy

ğŸ§ª Ver clases del dÃ­a actual (dÃ­a 3)
   GET /profesores/dashboard/clases-hoy
âœ… Status: 200 (esperado: 200)
   âœ… Respuesta exitosa
   ğŸ“„ Datos: [
  {
    id: '8beb4af4-e151-4070-b39b-1915aa0011b2',
    diaSemana: 3,
    horaInicio: '08:00',
    horaFin: '09:00',
    grupo: {
      id: '0d72c922-e10b-4ea6-8afd-e6b26234a415',
      nombre: 'Grupo A',
      grado: '1ro',
      seccion: 'A'
    },
    materia: {
      id: 'f048b756-4fc6-4586-b03a-abc272a5d100',
      nombre: 'FÃ­sica',
      codigo: 'FIS101'
    },
    periodoAcademico: {
      id: 'b26845b1-763b-4739-98e0-0ecfecc45a7f',
      nombre: 'Periodo 2025-1',
      activo: true
    },
    institucion: {
      id: '7d1e254c-3774-41c9-aa50-ffa10a9b6205',
      nombre: 'Colegio San JosÃ©'
    }
  }
]

ğŸ“± 6.2 CLASES POR DÃA ESPECÃFICO - Profesor consulta diferentes dÃ­as

ğŸ§ª Ver clases del Lunes (dÃ­a 1)
   GET /profesores/dashboard/clases/1
âœ… Status: 200 (esperado: 200)
   âœ… Respuesta exitosa

ğŸ§ª Ver clases del Martes (dÃ­a 2)
   GET /profesores/dashboard/clases/2
âœ… Status: 200 (esperado: 200)
   âœ… Respuesta exitosa

ğŸ§ª Ver clases del MiÃ©rcoles (dÃ­a 3)
   GET /profesores/dashboard/clases/3
âœ… Status: 200 (esperado: 200)
   âœ… Respuesta exitosa

ğŸ§ª Ver clases del Jueves (dÃ­a 4)
   GET /profesores/dashboard/clases/4
âœ… Status: 200 (esperado: 200)
   âœ… Respuesta exitosa

ğŸ§ª Ver clases del Viernes (dÃ­a 5)
   GET /profesores/dashboard/clases/5
âœ… Status: 200 (esperado: 200)
   âœ… Respuesta exitosa

ğŸ§ª Ver clases del SÃ¡bado (dÃ­a 6)
   GET /profesores/dashboard/clases/6
âœ… Status: 200 (esperado: 200)
   âœ… Respuesta exitosa

ğŸ§ª Ver clases del Domingo (dÃ­a 7)
   GET /profesores/dashboard/clases/7
âœ… Status: 200 (esperado: 200)
   âœ… Respuesta exitosa

ğŸ“± 6.3 HORARIO SEMANAL COMPLETO - Profesor ve todo su horario

ğŸ§ª Ver horario semanal completo
   GET /profesores/dashboard/horario-semanal
âœ… Status: 200 (esperado: 200)
   âœ… Respuesta exitosa
   ğŸ“„ Datos: {
  '1': [
    {
      id: 'd2c98398-f097-4340-9af6-a1ca40282141',
      diaSemana: 1,
      horaInicio: '08:00',
      horaFin: '09:00',
      grupo: [Object],
      materia: [Object],
      periodoAcademico: [Object],
      institucion: [Object]
    }
  ],
  '2': [
    {
      id: 'f7890dd8-a1f1-4b30-8cf5-6e3026a89e9d',
      diaSemana: 2,
      horaInicio: '08:00',
      horaFin: '09:00',
      grupo: [Object],
      materia: [Object],
      periodoAcademico: [Object],
      institucion: [Object]
    }
  ],
  '3': [
    {
      id: '8beb4af4-e151-4070-b39b-1915aa0011b2',
      diaSemana: 3,
      horaInicio: '08:00',
      horaFin: '09:00',
      grupo: [Object],
      materia: [Object],
      periodoAcademico: [Object],
      institucion: [Object]
    }
  ],
  '4': [],
  '5': [],
  '6': [],
  '7': []
}

ğŸ“± 6.4 ACCESO DENEGADO - Otros roles intentan ver dashboard del profesor

ğŸ§ª Admin instituciÃ³n intenta ver dashboard profesor (debe fallar)
   GET /profesores/dashboard/clases-hoy
âŒ Status: 401 (esperado: 403)
   Error: { success: false }

ğŸ§ª Estudiante intenta ver dashboard profesor (debe fallar)
   GET /profesores/dashboard/clases-hoy
âœ… Status: 403 (esperado: 403)
   âš ï¸  Respuesta esperada con error: undefined

ğŸ“± 6.5 ACCESO SIN AUTENTICACIÃ“N - Usuario no logueado

ğŸ§ª Acceder a dashboard sin autenticaciÃ³n (debe fallar) (Sin autenticaciÃ³n)
   GET /profesores/dashboard/clases-hoy
âœ… Status: 401 (esperado: 401)

ğŸ“ ===== FLUJO 7: DASHBOARD DEL ESTUDIANTE =====

ğŸ“± 7.1 INTENTANDO ACCEDER A DASHBOARD ESTUDIANTE

ğŸ§ª Ver clases del dÃ­a - Estudiante
   GET /estudiantes/dashboard/clases-hoy
âœ… Status: 200 (esperado: 200)
   âœ… Respuesta exitosa
   ğŸ“„ Datos: [
  {
    id: '8beb4af4-e151-4070-b39b-1915aa0011b2',
    diaSemana: 3,
    horaInicio: '08:00',
    horaFin: '09:00',
    materia: {
      id: 'f048b756-4fc6-4586-b03a-abc272a5d100',
      nombre: 'FÃ­sica',
      codigo: 'FIS101'
    },
    profesor: {
      id: '3ab9cc61-3324-4ae9-a4e1-9952fb4a00ae',
      nombres: 'Ana',
      apellidos: 'LÃ³pez'
    },
    grupo: {
      id: '0d72c922-e10b-4ea6-8afd-e6b26234a415',
      nombre: 'Grupo A',
      grado: '1ro',
      seccion: 'A'
    }
  }
]

ğŸ“± 7.2 ACCESO DENEGADO - Otros roles intentan ver dashboard estudiante

ğŸ§ª Admin instituciÃ³n intenta ver dashboard estudiante (debe fallar)
   GET /estudiantes/dashboard/clases-hoy
âŒ Status: 401 (esperado: 403)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ§ª Profesor intenta ver dashboard estudiante (debe fallar)
   GET /estudiantes/dashboard/clases-hoy
âœ… Status: 403 (esperado: 403)
   âš ï¸  Respuesta esperada con error: undefined

âš ï¸ ===== FLUJO 8: VALIDACIONES Y MANEJO DE ERRORES =====

ğŸ“± 8.1 TOKENS EXPIRADOS O INVÃLIDOS
   âœ… Token invÃ¡lido correctamente rechazado

ğŸ“± 8.2 PARÃMETROS INVÃLIDOS EN QUERIES

ğŸ§ª PaginaciÃ³n con pÃ¡gina negativa (debe fallar)
   GET /grupos?page=-1&limit=10
âŒ Status: 401 (esperado: 400)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ§ª PaginaciÃ³n con lÃ­mite cero (debe fallar)
   GET /grupos?page=1&limit=0
âŒ Status: 401 (esperado: 400)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ§ª DÃ­a de semana 0 invÃ¡lido (debe fallar)
   GET /profesores/dashboard/clases/0
âœ… Status: 400 (esperado: 400)
   âš ï¸  Respuesta esperada con error: undefined

ğŸ§ª DÃ­a de semana 8 invÃ¡lido (debe fallar)
   GET /profesores/dashboard/clases/8
âœ… Status: 400 (esperado: 400)
   âš ï¸  Respuesta esperada con error: undefined

ğŸ“± 8.3 IDs INEXISTENTES

ğŸ§ª Buscar grupo con ID inexistente (debe fallar)
   GET /grupos/00000000-0000-0000-0000-000000000000
âŒ Status: 401 (esperado: 404)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ§ª Buscar materia con ID inexistente (debe fallar)
   GET /materias/00000000-0000-0000-0000-000000000000
âŒ Status: 401 (esperado: 404)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ§ª Buscar horario con ID inexistente (debe fallar)
   GET /horarios/00000000-0000-0000-0000-000000000000
âŒ Status: 401 (esperado: 404)
   Error: {
  success: false,
  error: 'Token de autenticaciÃ³n invÃ¡lido',
  code: 'AUTHENTICATION_ERROR'
}

ğŸ“± 8.4 MÃ‰TODOS HTTP INCORRECTOS
   âœ… POST sin datos requeridos correctamente rechazado

ğŸ¯ ===== RESULTADOS FINALES =====
Total de pruebas ejecutadas: 59
Pruebas exitosas: 32
Pruebas fallidas: 27
Tasa de Ã©xito: 54.2%

ğŸ“‹ RESUMEN DE FLUJOS PROBADOS:
â€¢ ğŸ” AutenticaciÃ³n completa y gestiÃ³n de sesiones
â€¢ ğŸ‘¨â€ğŸ« GestiÃ³n completa de Profesores (CRUD + toggle status)
â€¢ ğŸ« GestiÃ³n completa de Grupos (CRUD)
â€¢ ğŸ“š GestiÃ³n completa de Materias (CRUD)
â€¢ ğŸ“… GestiÃ³n completa de Horarios (CRUD)
â€¢ ğŸ‘¨â€ğŸ« Dashboard del Profesor (clases del dÃ­a, semanal)
â€¢ ğŸ“ Dashboard del Estudiante (bÃ¡sico)
â€¢ âš ï¸ Validaciones exhaustivas y manejo de errores
â€¢ ğŸš« Control de acceso basado en roles
â€¢ ğŸ“± SimulaciÃ³n completa de flujos de Flutter

âš ï¸ 27 pruebas fallaron. Revisa los logs anteriores para detalles.
ğŸ”§ Algunos flujos pueden necesitar ajustes o pueden no estar implementados aÃºn.

ğŸ“Š ENTIDADES CREADAS DURANTE LAS PRUEBAS:

ğŸ’¡ RECOMENDACIONES:
â€¢ Implementar endpoints faltantes si algunas pruebas fallaron
â€¢ Agregar mÃ¡s validaciones de negocio segÃºn requerimientos
â€¢ Considerar implementar rate limiting para producciÃ³n
â€¢ Agregar logging detallado para debugging
â€¢ Implementar tests de carga para endpoints crÃ­ticos
