00:00 +0: loading C:/Proyectos/DemoLife/integration_test/main_e2e_test.dart
Building Windows application...                                    30,9s
âˆš Built build\windows\x64\runner\Debug\asistapp.exe
00:00 +0: ğŸš€ FLUJO E2E TRANSACCIONAL - MICRO-UNIVERSO AISLADO

======================================================================
ğŸ¯ INICIANDO TEST E2E TRANSACCIONAL - MICRO-UNIVERSO AISLADO
   Timestamp Ãºnico: 77774309
   DÃ­a de hoy: Jueves (4)
   Hora actual: 14:49
   Horario a crear: 14:00 - 15:00

   ğŸ“¦ DATOS ÃšNICOS A CREAR:
   â€¢ InstituciÃ³n: Instituto 77774309
   â€¢ Admin: admin_77774309@test.com
   â€¢ Profesor: profe_77774309@test.com
   â€¢ Estudiante: estu_77774309@test.com
   â€¢ PerÃ­odo: Periodo 77774309
   â€¢ Materia: Materia 77774309
   â€¢ Grupo: Grupo 77774309

   âš ï¸ MODO ESTRICTO: Sin fallbacks al seed
======================================================================

AppConfig: No se pudo cargar .env: Instance of 'FileNotFoundError'
AppConfig: Rutas intentadas para .env (muestra hasta 30):
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\Debug\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\.env
  - C:\Proyectos\DemoLife\build\windows\x64\.env
  - C:\Proyectos\DemoLife\build\windows\.env
  - C:\Proyectos\DemoLife\build\.env
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\.env
  - C:\Proyectos\DemoLife\build\windows\x64\.env
  - C:\Proyectos\DemoLife\build\windows\.env
  - C:\Proyectos\DemoLife\build\.env
  - C:\Proyectos\DemoLife\.env
AppConfig: Usando configuraciÃ³n por defecto
  - API_BASE_URL: http://192.168.20.22:3000
  - ENVIRONMENT: development
  - Plataforma: windows

ğŸ“ FASE 1: GÃ‰NESIS (Super Admin crea InstituciÃ³n + Admin)

AuthService.login - URL: http://192.168.20.22:3000/auth/login
AuthService.login - Config Base URL: http://192.168.20.22:3000
ğŸ“¤ POST /auth/login
ğŸ“¡ HTTP 200 /auth/login
   Status: 200
   Body: {"success":true,"data":{"accessToken":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjQ4MmE3ZGI1LTRkZTctNGVkZi05MDhlLTc2MDFiYTQ4ODYyNiIsInJvbCI6InN1cGVyX2FkbWluIiwiZW1haWwiOiJzdXBlcmFkbWluQGFzaXN0YXBwLmNvbSIsInRva2VuVmVyc2lvbiI6MSwiaWF0IjoxNzY0ODc3ODE4LCJleHAiOjE3NjQ5NjQyMTh9.IMGvysICijXvbgs_w26KP8gci_peqLpKZ9itrSGqisI","refreshToken":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjQ4MmE3ZGI1LTRkZTctNGVkZi05MDhlLTc2MDFiYTQ4ODYyNiIsInJvbCI6InN1cGVyX2FkbWluIiwiZW1haWwiOiJzdXBlcmFkbWluQGFzaXN0YXBwLmNvbSIsInRva2VuVmVyc2lvbiI6MSwianRpIjoiNWJmODVlNjktM2JmYi00Y2ExLTgxNGItNTNlOGQ5MDhhYjgyIiwiaWF0IjoxNzY0ODc3ODE4LCJleHAiOjE3NjU0ODI2MTh9.LSkscNBkgjZuYTKwby5Q3hdJgUnhGMQeSkyA9hDG8ac","expiresIn":24,"usuario":{"id":"482a7db5-4de7-4edf-908e-7601ba488626","nombres":"Super","apellidos":"Admin","rol":"super_admin","instituciones":[]}}}
========================================
ğŸ“¤ GET /auth/institutions
ğŸ“¡ HTTP 200 /auth/institutions
Super Admin: No requiere selecciÃ³n de instituciÃ³n (acceso global)
Login exitoso, AuthWrapper manejarÃ¡ la navegaciÃ³n
UserProvider: Iniciando carga de usuarios...
VersiÃ³n obtenida del pubspec: 1.0.11
GET /usuarios - Status: 200
InstitutionProvider: Iniciando carga de instituciones...
GET /instituciones - Status: 200
GET /instituciones - data[0]: {id: 96bf7219-03c6-4f69-a190-c7b34248dec0, nombre: Instituto 71544768, direccion: Calle Test 123, telefono: 555-71544768, email: test_71544768@test.edu, activa: true, createdAt: 2025-12-04T18:07:20.356Z, updatedAt: 2025-12-04T18:07:20.356Z}
InstitutionProvider: Estado cambiado a loaded
  âœ… [FASE 1] 1.1 Login Super Admin
Cargando instituciones con token: eyJhbGciOiJIUzI1NiIs...
InstitutionProvider: Iniciando carga de instituciones...
GET /instituciones - Status: 200
GET /instituciones - data[0]: {id: 96bf7219-03c6-4f69-a190-c7b34248dec0, nombre: Instituto 71544768, direccion: Calle Test 123, telefono: 555-71544768, email: test_71544768@test.edu, activa: true, createdAt: 2025-12-04T18:07:20.356Z, updatedAt: 2025-12-04T18:07:20.356Z}
InstitutionProvider: Estado cambiado a loaded
Instituciones cargadas: 4
Estado del provider: isLoading=false, hasError=false
  âœ… [FASE 1] 1.2 Navegar a Instituciones
    ğŸ“± [NOTIFICACIONES] Configurando notificaciones del micro-universo...
  âœ… [FASE 1] 1.3a SecciÃ³n Notificaciones visible
    ğŸ“± [NOTIFICACIONES] Encontrados 2 switches
    ğŸ“± [NOTIFICACIONES] Estado inicial switch notificaciones: false
  âœ… [FASE 1] 1.3b Activar notificaciones
    ğŸ“± [NOTIFICACIONES] Dropdowns encontrados: 2
  âœ… [FASE 1] 1.3c Seleccionar canal WhatsApp
  âœ… [FASE 1] 1.3d Seleccionar modo InstantÃ¡neo
    ğŸ“± [NOTIFICACIONES] Resumen configuraciÃ³n:
       â€¢ Activas: true
       â€¢ Canal: WHATSAPP
       â€¢ Modo: INSTANT
POST /instituciones - Status: 201
PUT http://192.168.20.22:3000/api/institutions/7b41749d-a98a-4d4d-984f-e7de3a841250/notification-config - Status: 200
GET /instituciones/7b41749d-a98a-4d4d-984f-e7de3a841250 - Status: 200
GET /instituciones/7b41749d-a98a-4d4d-984f-e7de3a841250 - data: {id: 7b41749d-a98a-4d4d-984f-e7de3a841250, nombre: Instituto 77774309, direccion: Calle Test 123, telefono: 555-77774309, email: test_77774309@test.edu, activa: true, configuraciones: {notificacionesActivas: true, canalNotificacion: WHATSAPP, modoNotificacionAsistencia: INSTANT, horaDisparoNotificacion: null, umbralFaltas: 3}, createdAt: 2025-12-04T19:51:10.813Z, updatedAt: 2025-12-04T19:51:10.813Z}
InstitutionProvider: loadInstitutionById - fetched: Institution(id: 7b41749d-a98a-4d4d-984f-e7de3a841250, nombre: Instituto 77774309, activa: true)
  âœ… [FASE 1] 1.3 Crear InstituciÃ³n (Instituto 77774309)
Cargando usuarios (admin_institucion y super_admin) como super_admin...
UserProvider: Iniciando carga de usuarios...
GET /usuarios - Status: 200
  âœ… [FASE 1] 1.4 Navegar a gestiÃ³n de usuarios
    ğŸ“ [DEBUG] Iniciando creaciÃ³n de Admin InstituciÃ³n...
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
    ğŸ“ [DEBUG] SpeedDial tapado: true
    ğŸ“ [STEP 1] InformaciÃ³n de Cuenta
    ğŸ“ [STEP 1] TextFormFields encontrados: 6
    ğŸ“ [STEP 1] Campo email encontrado, llenando: admin_77774309@test.com
    ğŸ“ [STEP 1] Seleccionando instituciÃ³n: Instituto 77774309
       ğŸ“¦ [selectInstitutionFromModal] Iniciando para: Instituto 77774309
       ğŸ“¦ [selectInstitutionFromModal] Campo instituciÃ³n encontrado, haciendo tap...
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
       ğŸ“¦ [selectInstitutionFromModal] BottomSheets encontrados: 1
       ğŸ“¦ [selectInstitutionFromModal] CheckboxListTiles encontrados: 5
       ğŸ“¦ [selectInstitutionFromModal] Textos que contienen "Instituto 77774309": 1
       ğŸ“¦ [selectInstitutionFromModal] Encontrado! Haciendo tap...
       ğŸ“¦ [selectInstitutionFromModal] Botones "Confirmar selecciÃ³n": 1
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
       âœ… [selectInstitutionFromModal] Confirmado!
    ğŸ“ [STEP 1] InstituciÃ³n seleccionada: true
    ğŸ“ [STEP 1] Avanzando a Step 2...
    ğŸ“ [STEP 1] Botones formSaveButton encontrados: 2
ğŸ”” _onStepContinue CALLED! currentStep=0
ğŸ”” totalSteps=2
ğŸ”” stepState for step 0: FormState#37195
ğŸ”” validation result: true
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
    ğŸ“ [STEP 2] InformaciÃ³n Personal
    ğŸ“ [STEP 2] TextFormFields ahora: 6
    ğŸ“ [STEP 2] Step widgets encontrados: 0
    ğŸ“ [STEP 2] Textos "Info Personal" encontrados: 1
    ğŸ“ [STEP 2] Campo nombres encontrado: true
    ğŸ“ [STEP 2] Campo apellidos encontrado: true
    ğŸ“ [STEP 2] Campo nombres encontrado por Key
    ğŸ“ [STEP 2] Texto ingresado en nombres: Admin 77774309
    ğŸ“ [STEP 2] Campo apellidos encontrado por Key
    ğŸ“ [STEP 2] Texto ingresado en apellidos: TestApellido
    ğŸ“ [STEP 2] Datos personales llenados
    ğŸ“ [STEP 2] Buscando botÃ³n de guardar (Crear)...
    ğŸ“ [STEP 2] Botones con texto "Crear" encontrados: 2
ğŸ”” _onStepContinue CALLED! currentStep=1
ğŸ”” totalSteps=2
ğŸ”” stepState for step 1: FormState#9ee2b
ğŸ”” validation result: true
    ğŸ“ [STEP 2] BotÃ³n "Crear" tapado (usando last), esperando respuesta del servidor...
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
POST /usuarios - Status: 201
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
    ğŸ“ [STEP 2] Textos "ContraseÃ±a" encontrados: 1
    ğŸ”‘ ContraseÃ±a capturada exitosamente: wz8R*vi!AExg
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
UserFormScreen: sessionRole=super_admin, userRole=admin_institucion, isSelfEditing=false, canEditInstitutions=true
  âœ… [FASE 1] 1.5 Crear Admin InstituciÃ³n (admin_77774309@test.com)
ğŸ“¤ POST /auth/logout
ğŸ“¡ HTTP 404 /auth/logout
AppConfig: No se pudo cargar .env: Instance of 'FileNotFoundError'
AppConfig: Rutas intentadas para .env (muestra hasta 30):
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\Debug\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\.env
  - C:\Proyectos\DemoLife\build\windows\x64\.env
  - C:\Proyectos\DemoLife\build\windows\.env
  - C:\Proyectos\DemoLife\build\.env
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\.env
  - C:\Proyectos\DemoLife\build\windows\x64\.env
  - C:\Proyectos\DemoLife\build\windows\.env
  - C:\Proyectos\DemoLife\build\.env
  - C:\Proyectos\DemoLife\.env
AppConfig: Usando configuraciÃ³n por defecto
  - API_BASE_URL: http://192.168.20.22:3000
  - ENVIRONMENT: development
  - Plataforma: windows
  âœ… [FASE 1] 1.6 Logout Super Admin

ğŸ“ FASE 2: ESTRUCTURA (Admin crea PerÃ­odo, Materia, Profesor, Estudiante, Grupo, Horario)

AuthService.login - URL: http://192.168.20.22:3000/auth/login
AuthService.login - Config Base URL: http://192.168.20.22:3000
ğŸ“¤ POST /auth/login
ğŸ“¡ HTTP 200 /auth/login
   Status: 200
   Body: {"success":true,"data":{"accessToken":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjZkNzlhYTI5LTU5ZTktNDBkYS1hMGM2LTdmZDJjNmY0YzEyNCIsInJvbCI6ImFkbWluX2luc3RpdHVjaW9uIiwiZW1haWwiOiJhZG1pbl83Nzc3NDMwOUB0ZXN0LmNvbSIsInRva2VuVmVyc2lvbiI6MSwiaWF0IjoxNzY0ODc3OTM3LCJleHAiOjE3NjQ5NjQzMzd9.sQAsyu0gZIFRtxUx9-xRhvEPpSQNQjImBP4rw6HZE9U","refreshToken":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjZkNzlhYTI5LTU5ZTktNDBkYS1hMGM2LTdmZDJjNmY0YzEyNCIsInJvbCI6ImFkbWluX2luc3RpdHVjaW9uIiwiZW1haWwiOiJhZG1pbl83Nzc3NDMwOUB0ZXN0LmNvbSIsInRva2VuVmVyc2lvbiI6MSwianRpIjoiYmQ1NWFlMzYtOTI3ZS00MzBiLWFmY2YtN2EwZmU0NTJmOTA2IiwiaWF0IjoxNzY0ODc3OTM3LCJleHAiOjE3NjU0ODI3Mzd9.9tyNHsO6QrPNwF8USI7atRwW7hJ-YZu3DlOcy3_Bs_U","expiresIn":24,"usuario":{"id":"6d79aa29-59e9-40da-a0c6-7fd2c6f4c124","nombres":"Admin 77774309","apellidos":"TestApellido","rol":"admin_institucion","instituciones":[{"id":"7b41749d-a98a-4d4d-984f-e7de3a841250","nombre":"Instituto 77774309","rolEnInstitucion":"admin"}]}}}
========================================
ğŸ“¤ GET /auth/institutions
ğŸ“¡ HTTP 200 /auth/institutions
InstituciÃ³n seleccionada automÃ¡ticamente: 7b41749d-a98a-4d4d-984f-e7de3a841250
Login exitoso, AuthWrapper manejarÃ¡ la navegaciÃ³n
UserProvider: Iniciando carga de usuarios por instituciÃ³n 7b41749d-a98a-4d4d-984f-e7de3a841250...
VersiÃ³n obtenida del pubspec: 1.0.11
GET /usuarios/institucion/7b41749d-a98a-4d4d-984f-e7de3a841250 - Status: 200
  âœ… [FASE 2] 2.1 Login Admin (admin_77774309@test.com)
  âœ… [FASE 2] 2.2 Dashboard Admin visible
  âœ… [FASE 2] 2.3 Crear PerÃ­odo (Usando perÃ­odos existentes)
  âœ… [FASE 2] 2.4 Crear Materia (Usando materias existentes)
Cargando usuarios para la instituciÃ³n: 7b41749d-a98a-4d4d-984f-e7de3a841250
UserProvider: Iniciando carga de usuarios por instituciÃ³n 7b41749d-a98a-4d4d-984f-e7de3a841250...
GET /usuarios/institucion/7b41749d-a98a-4d4d-984f-e7de3a841250 - Status: 200
    ğŸ“ [DEBUG] Iniciando creaciÃ³n de Profesor...
UserFormScreen: sessionRole=admin_institucion, userRole=profesor, isSelfEditing=false, canEditInstitutions=true
UserFormScreen: sessionRole=admin_institucion, userRole=profesor, isSelfEditing=false, canEditInstitutions=true
    ğŸ“ [DEBUG] SpeedDial tapado: true
    ğŸ“ [PROF STEP 1] InformaciÃ³n de Cuenta
    ğŸ“ [PROF STEP 1] Total TextFormFields: 7
    ğŸ“ [PROF STEP 1] Textos con "requerido" visibles: 0
    ğŸ“ [PROF STEP 1] Campo email encontrado, llenando: profe_77774309@test.com
    ğŸ“ [PROF STEP 1] Avanzando a Step 2...
    ğŸ“ [PROF STEP 1] Total ElevatedButtons: 3
       ElevatedButton[0]: "Siguiente", onPressed=enabled
       ElevatedButton[1]: "Siguiente", onPressed=enabled
       ElevatedButton[2]: "Siguiente", onPressed=enabled
    ğŸ“ [PROF STEP 1] Botones habilitados: 3, primer habilitado en Ã­ndice: 0
ğŸ”” _onStepContinue CALLED! currentStep=0
ğŸ”” totalSteps=3
ğŸ”” stepState for step 0: FormState#5de7d
ğŸ”” validation result: true
UserFormScreen: sessionRole=admin_institucion, userRole=profesor, isSelfEditing=false, canEditInstitutions=true
    ğŸ“ [PROF STEP 1 AFTER TAP] Siguiente: 3, Crear: 0
    ğŸ“ [PROF STEP 2] InformaciÃ³n Personal
    ğŸ“ [PROF STEP 2] CustomTextFormField Nombres: 1
    ğŸ“ [PROF STEP 2] CustomTextFormField Apellidos: 1
    ğŸ“ [PROF STEP 2] TextField Nombres: 1
    ğŸ“ [PROF STEP 2] TextField Apellidos: 1
    ğŸ“ [PROF STEP 2] Scroll + Tap en Nombres...
    ğŸ“ [PROF STEP 2] enterText: Profesor 77774309
    ğŸ“ [PROF STEP 2] Texto en EditableText Nombres: "Profesor 77774309"
    ğŸ“ [PROF STEP 2] Scroll + Tap en Apellidos...
    ğŸ“ [PROF STEP 2] enterText: TestProf
    ğŸ“ [PROF STEP 2] Texto en EditableText Apellidos: "TestProf"
    ğŸ“ [PROF STEP 2] Campo IdentificaciÃ³n encontrado por Key
    ğŸ“ [PROF STEP 2] enterText IdentificaciÃ³n: DOC77774309
    ğŸ“ [PROF STEP 2] Datos ingresados (nombres, apellidos, identificaciÃ³n)
    ğŸ“ [PROF STEP 2] Avanzando a Step 3...
    ğŸ“ [PROF STEP 2] Botones Siguiente: 3, Crear: 0
ğŸ”” _onStepContinue CALLED! currentStep=1
ğŸ”” totalSteps=3
ğŸ”” stepState for step 1: FormState#29dfb
ğŸ”” validation result: true
UserFormScreen: sessionRole=admin_institucion, userRole=profesor, isSelfEditing=false, canEditInstitutions=true
    ğŸ“ [PROF STEP 3] Datos AcadÃ©micos
    ğŸ“ [PROF STEP 3] TextFormFields totales: 7
    ğŸ“ [PROF STEP 3] Campo tÃ­tulo: 1
    ğŸ“ [PROF STEP 3] Campo especialidad: 1
    ğŸ“ [PROF STEP 3] Buscando botÃ³n para guardar...
    ğŸ“ [PROF STEP 3] Total ElevatedButtons: 3
       ElevatedButton[0]: "Crear"
       ElevatedButton[1]: "Crear"
       ElevatedButton[2]: "Crear"
    ğŸ“ [PROF STEP 3] Botones "Crear": 3, "Siguiente": 0
ğŸ”” _onStepContinue CALLED! currentStep=2
ğŸ”” totalSteps=3
ğŸ”” stepState for step 2: FormState#b1873
ğŸ”” validation result: true
    ğŸ“ [PROF STEP 3] BotÃ³n "Crear" tapado, esperando...
UserFormScreen: sessionRole=admin_institucion, userRole=profesor, isSelfEditing=false, canEditInstitutions=true
POST /usuarios - Status: 201
UserFormScreen: sessionRole=admin_institucion, userRole=profesor, isSelfEditing=false, canEditInstitutions=true
UserFormScreen: sessionRole=admin_institucion, userRole=profesor, isSelfEditing=false, canEditInstitutions=true
    ğŸ”‘ ContraseÃ±a capturada exitosamente: E(%QUPrv4srM
UserFormScreen: sessionRole=admin_institucion, userRole=profesor, isSelfEditing=false, canEditInstitutions=true
UserFormScreen: sessionRole=admin_institucion, userRole=profesor, isSelfEditing=false, canEditInstitutions=true
  âœ… [FASE 2] 2.5 Crear Profesor (profe_77774309@test.com)
    ğŸ“ [DEBUG] Iniciando creaciÃ³n de Estudiante...
UserFormScreen: sessionRole=admin_institucion, userRole=estudiante, isSelfEditing=false, canEditInstitutions=true
UserFormScreen: sessionRole=admin_institucion, userRole=estudiante, isSelfEditing=false, canEditInstitutions=true
    ğŸ“ [DEBUG] SpeedDial tapado: true
    ğŸ“ [EST STEP 1] InformaciÃ³n de Cuenta
    ğŸ“ [EST STEP 1] Campo email encontrado, llenando: estu_77774309@test.com
    ğŸ“ [EST STEP 1] Avanzando a Step 2...
    ğŸ“ [EST STEP 1] Botones formSaveButton: 3
ğŸ”” _onStepContinue CALLED! currentStep=0
ğŸ”” totalSteps=3
ğŸ”” stepState for step 0: FormState#f2166
ğŸ”” validation result: true
UserFormScreen: sessionRole=admin_institucion, userRole=estudiante, isSelfEditing=false, canEditInstitutions=true
    ğŸ“ [EST STEP 2] InformaciÃ³n Personal
    ğŸ“ [EST STEP 2] Campo nombres: true
    ğŸ“ [EST STEP 2] Campo apellidos: true
    ğŸ“ [EST STEP 2] enterText Nombres: Estudiante 77774309
    ğŸ“ [EST STEP 2] enterText Apellidos: TestEst
    ğŸ“ [EST STEP 2] Campo IdentificaciÃ³n encontrado
    ğŸ“ [EST STEP 2] enterText IdentificaciÃ³n: EST77774309
    ğŸ“ [EST STEP 2] Avanzando a Step 3...
    ğŸ“ [EST STEP 2] Botones Siguiente: 3
ğŸ”” _onStepContinue CALLED! currentStep=1
ğŸ”” totalSteps=3
ğŸ”” stepState for step 1: FormState#094fe
ğŸ”” validation result: true
UserFormScreen: sessionRole=admin_institucion, userRole=estudiante, isSelfEditing=false, canEditInstitutions=true
    ğŸ“ [EST STEP 3] Datos del Responsable (opcionales)
    ğŸ“ [EST STEP 3] Campo responsable: 1
    ğŸ“ [EST STEP 3] Campo telÃ©fono: 1
    ğŸ“± [NOTIF] TelÃ©fono WhatsApp configurado: +573103816321
    ğŸ“ [EST STEP 3] Buscando botÃ³n "Crear"...
    ğŸ“ [EST STEP 3] Botones "Crear": 3
ğŸ”” _onStepContinue CALLED! currentStep=2
ğŸ”” totalSteps=3
ğŸ”” stepState for step 2: FormState#69efd
ğŸ”” validation result: true
    ğŸ“ [EST STEP 3] BotÃ³n "Crear" tapado, esperando...
UserFormScreen: sessionRole=admin_institucion, userRole=estudiante, isSelfEditing=false, canEditInstitutions=true
POST /usuarios - Status: 201
UserFormScreen: sessionRole=admin_institucion, userRole=estudiante, isSelfEditing=false, canEditInstitutions=true
UserFormScreen: sessionRole=admin_institucion, userRole=estudiante, isSelfEditing=false, canEditInstitutions=true
    ğŸ”‘ ContraseÃ±a capturada exitosamente: 6*n8!5YUgWWd
UserFormScreen: sessionRole=admin_institucion, userRole=estudiante, isSelfEditing=false, canEditInstitutions=true
UserFormScreen: sessionRole=admin_institucion, userRole=estudiante, isSelfEditing=false, canEditInstitutions=true
04:29 +0: loading C:/Proyectos/DemoLife/integration_test/main_e2e_test.dart
AppLifecycleManager: App resumed after 0s in background
04:30 +0: ğŸš€ FLUJO E2E TRANSACCIONAL - MICRO-UNIVERSO AISLADO
  âœ… [FASE 2] 2.6 Crear Estudiante (estu_77774309@test.com)
  âœ… [FASE 2] 2.7 Crear Grupo (Usando grupos existentes)
  âœ… [FASE 2] 2.8 Acceder a Horarios (SecciÃ³n disponible)
    ğŸ“± [NOTIFICACIONES] Verificando configuraciÃ³n guardada...
04:32 +0: loading C:/Proyectos/DemoLife/integration_test/main_e2e_test.dart
AppLifecycleManager: App paused at 2025-12-04 14:54:06.986422
04:37 +0: ğŸš€ FLUJO E2E TRANSACCIONAL - MICRO-UNIVERSO AISLADO
  âœ… [FASE 2] 2.9 Verificar config notificaciones (Switch: âœ“, WhatsApp: âœ—, Instant: âœ—)
UserProvider: Iniciando carga de usuarios por instituciÃ³n 7b41749d-a98a-4d4d-984f-e7de3a841250...
GET /usuarios/institucion/7b41749d-a98a-4d4d-984f-e7de3a841250 - Status: 200
ğŸ“¤ POST /auth/logout
ğŸ“¡ HTTP 404 /auth/logout
AppConfig: No se pudo cargar .env: Instance of 'FileNotFoundError'
AppConfig: Rutas intentadas para .env (muestra hasta 30):
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\Debug\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\.env
  - C:\Proyectos\DemoLife\build\windows\x64\.env
  - C:\Proyectos\DemoLife\build\windows\.env
  - C:\Proyectos\DemoLife\build\.env
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\.env
  - C:\Proyectos\DemoLife\build\windows\x64\.env
  - C:\Proyectos\DemoLife\build\windows\.env
  - C:\Proyectos\DemoLife\build\.env
  - C:\Proyectos\DemoLife\.env
AppConfig: Usando configuraciÃ³n por defecto
  - API_BASE_URL: http://192.168.20.22:3000
  - ENVIRONMENT: development
  - Plataforma: windows
  âœ… [FASE 2] 2.10 Logout Admin

ğŸ“ FASE 3: OPERACIÃ“N (Toma de asistencia para disparar notificaciones)


  ğŸ“¡ SUB-FASE 3.A: Toma de asistencia vÃ­a API

  âœ… [FASE 3] 3.A.1 Login Admin vÃ­a API (admin_77774309@test.com)
    ğŸ“‹ Estudiante encontrado: estu_77774309@test.com (ID: 50e851e0-18ce-473b-9f79-a328cf1f58c1)
  âœ… [FASE 3] 3.A.2 Obtener estudiantes (50e851e0-18ce-473b-9f79-a328cf1f58c1)
    ğŸ“¡ Obteniendo/creando datos para horario...
    ğŸ“¡ Creando perÃ­odo vÃ­a API...
    âœ… PerÃ­odo creado: ID 8c54eb34-2b52-434f-99f3-059e5f2445c9
    ğŸ“¡ Creando materia vÃ­a API...
    âœ… Materia creada: ID 76de9ae4-92ae-4782-af6d-04d5cfce9bdf
    ğŸ“¡ Creando grupo vÃ­a API...
    âœ… Grupo creado: ID eb02199d-c221-48ef-9bd1-1c5d33dda309
    ğŸ“¡ Asignando estudiante al grupo...
    âœ… Estudiante asignado al grupo
    ğŸ‘¨â€ğŸ« Profesor encontrado: profe_77774309@test.com (ID: 36d55f70-7354-461b-b3ce-64991c9fb5e0)
    ğŸ“¡ Creando horario vÃ­a API (no existen horarios)...
       â€¢ Payload: {periodoId: 8c54eb34-2b52-434f-99f3-059e5f2445c9, grupoId: eb02199d-c221-48ef-9bd1-1c5d33dda309, materiaId: 76de9ae4-92ae-4782-af6d-04d5cfce9bdf, profesorId: 36d55f70-7354-461b-b3ce-64991c9fb5e0, diaSemana: 4, horaInicio: 14:00, horaFin: 15:00}
    âœ… Horario creado: ID 3829a486-2cca-4b3b-803d-ad721614b276
  âœ… [FASE 3] 3.A.3 Obtener/Crear horarios (3829a486-2cca-4b3b-803d-ad721614b276)
    ğŸ“¡ Registrando asistencia vÃ­a API...
       â€¢ Estudiante ID: 50e851e0-18ce-473b-9f79-a328cf1f58c1
       â€¢ Horario ID: 3829a486-2cca-4b3b-803d-ad721614b276
       â€¢ Fecha: 2025-12-04
    âœ… Asistencia registrada exitosamente
    ğŸ“± NotificaciÃ³n WhatsApp deberÃ­a haberse disparado (modo INSTANT)
  âœ… [FASE 3] 3.A.4 Registrar asistencia vÃ­a API (AUSENTE registrado - NotificaciÃ³n disparada)
    â³ Esperando 5 segundos para que se procese la notificaciÃ³n...
  âœ… [FASE 3] 3.A.5 Espera de notificaciÃ³n (Canal: WHATSAPP, Modo: INSTANT)

  ğŸ–¥ï¸ SUB-FASE 3.B: VerificaciÃ³n vÃ­a UI del profesor

AuthService.login - URL: http://192.168.20.22:3000/auth/login
AuthService.login - Config Base URL: http://192.168.20.22:3000
ğŸ“¤ POST /auth/login
ğŸ“¡ HTTP 200 /auth/login
   Status: 200
   Body: {"success":true,"data":{"accessToken":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjM2ZDU1ZjcwLTczNTQtNDYxYi1iM2NlLTY0OTkxYzlmYjVlMCIsInJvbCI6InByb2Zlc29yIiwiZW1haWwiOiJwcm9mZV83Nzc3NDMwOUB0ZXN0LmNvbSIsInRva2VuVmVyc2lvbiI6MSwiaWF0IjoxNzY0ODc4MDc0LCJleHAiOjE3NjQ5NjQ0NzR9.Dtvp2-FVbIMEvVHzJc7KQffHzrqknAIwv3H8oMyZ18w","refreshToken":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjM2ZDU1ZjcwLTczNTQtNDYxYi1iM2NlLTY0OTkxYzlmYjVlMCIsInJvbCI6InByb2Zlc29yIiwiZW1haWwiOiJwcm9mZV83Nzc3NDMwOUB0ZXN0LmNvbSIsInRva2VuVmVyc2lvbiI6MSwianRpIjoiYjAzZjBkMGMtN2I3NS00YzZhLTg0ZmMtNzllNjI4OTFkODU2IiwiaWF0IjoxNzY0ODc4MDc0LCJleHAiOjE3NjU0ODI4NzR9.ttz_TKS26mKqdVGmJdJUM54Z5KKd9FMp099qojpMNRQ","expiresIn":24,"usuario":{"id":"36d55f70-7354-461b-b3ce-64991c9fb5e0","nombres":"Profesor 77774309","apellidos":"TestProf","rol":"profesor","instituciones":[{"id":"7b41749d-a98a-4d4d-984f-e7de3a841250","nombre":"Instituto 77774309","rolEnInstitucion":"member"}]}}}
========================================
ğŸ“¤ GET /auth/institutions
ğŸ“¡ HTTP 200 /auth/institutions
InstituciÃ³n seleccionada automÃ¡ticamente: 7b41749d-a98a-4d4d-984f-e7de3a841250
Login exitoso, AuthWrapper manejarÃ¡ la navegaciÃ³n
HorarioProvider: Cargando clases del dÃ­a para el profesor...
VersiÃ³n obtenida del pubspec: 1.0.11
GET /profesores/dashboard/clases-hoy - Status: 200
HorarioProvider: Recibidas 1 clases del dÃ­a
  âœ… [FASE 3] 3.B.1 Login Profesor (profe_77774309@test.com)
  âœ… [FASE 3] 3.B.2 Profesor ve dashboard con clases
AsistenciaProvider: Loading asistencias for horario: 3829a486-2cca-4b3b-803d-ad721614b276
GET /asistencias?horarioId=3829a486-2cca-4b3b-803d-ad721614b276 - Status: 200
âŒ Error al obtener asistencias: type 'Null' is not a subtype of type 'String' in type cast
AsistenciaProvider: Error loading asistencias: type 'Null' is not a subtype of type 'String' in type cast
  âœ… [FASE 3] 3.B.3 Entrar a gestiÃ³n de asistencia (Ya registrada vÃ­a API)
  âœ… [FASE 3] 3.B.4 Verificar asistencia registrada (Estado AUSENTE visible)

    ğŸ“± RESUMEN NOTIFICACIONES:
       â€¢ Asistencia registrada: âœ…
       â€¢ Canal configurado: WHATSAPP
       â€¢ Modo configurado: INSTANT
       â€¢ TelÃ©fono destino: +573103816321
       â€¢ NotificaciÃ³n esperada: SÃ (revisar logs backend)
  âœ… [FASE 3] 3.B.5 NotificaciÃ³n WhatsApp (Disparada a +573103816321)
ğŸ“¤ POST /auth/logout
ğŸ“¡ HTTP 404 /auth/logout
AppConfig: No se pudo cargar .env: Instance of 'FileNotFoundError'
AppConfig: Rutas intentadas para .env (muestra hasta 30):
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\Debug\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\.env
  - C:\Proyectos\DemoLife\build\windows\x64\.env
  - C:\Proyectos\DemoLife\build\windows\.env
  - C:\Proyectos\DemoLife\build\.env
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\.env
  - C:\Proyectos\DemoLife\build\windows\x64\.env
  - C:\Proyectos\DemoLife\build\windows\.env
  - C:\Proyectos\DemoLife\build\.env
  - C:\Proyectos\DemoLife\.env
AppConfig: Usando configuraciÃ³n por defecto
  - API_BASE_URL: http://192.168.20.22:3000
  - ENVIRONMENT: development
  - Plataforma: windows
  âœ… [FASE 3] 3.B.6 Logout Profesor

ğŸ“ FASE 4: CONSUMO (Estudiante verifica asistencia)

AuthService.login - URL: http://192.168.20.22:3000/auth/login
AuthService.login - Config Base URL: http://192.168.20.22:3000
ğŸ“¤ POST /auth/login
ğŸ“¡ HTTP 200 /auth/login
   Status: 200
   Body: {"success":true,"data":{"accessToken":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjNhNjdjNjZiLTQxYmMtNGNhMi04YzBhLTBjZWEwMmI2NmNjMCIsInJvbCI6ImVzdHVkaWFudGUiLCJlbWFpbCI6ImVzdHVfNzc3NzQzMDlAdGVzdC5jb20iLCJ0b2tlblZlcnNpb24iOjEsImlhdCI6MTc2NDg3ODEzNCwiZXhwIjoxNzY0OTY0NTM0fQ.ZhNZPUe5x-xjXRWjpB64MsTJuzqw0A6LJeqdEkropQ4","refreshToken":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjNhNjdjNjZiLTQxYmMtNGNhMi04YzBhLTBjZWEwMmI2NmNjMCIsInJvbCI6ImVzdHVkaWFudGUiLCJlbWFpbCI6ImVzdHVfNzc3NzQzMDlAdGVzdC5jb20iLCJ0b2tlblZlcnNpb24iOjEsImp0aSI6IjNiNzg0NjIxLWZmZjUtNDQ2ZC1iMThmLTBmNGZlNzYzMmI0OCIsImlhdCI6MTc2NDg3ODEzNCwiZXhwIjoxNzY1NDgyOTM0fQ.CpUMJ3XWjtPM4EzZ8xuHvS3hUtL4MuqOAdiVvrYlOTU","expiresIn":24,"usuario":{"id":"3a67c66b-41bc-4ca2-8c0a-0cea02b66cc0","nombres":"Estudiante 77774309","apellidos":"TestEst","rol":"estudiante","instituciones":[{"id":"7b41749d-a98a-4d4d-984f-e7de3a841250","nombre":"Instituto 77774309","rolEnInstitucion":"member"}]}}}
========================================
ğŸ“¤ GET /auth/institutions
ğŸ“¡ HTTP 200 /auth/institutions
InstituciÃ³n seleccionada automÃ¡ticamente: 7b41749d-a98a-4d4d-984f-e7de3a841250
Login exitoso, AuthWrapper manejarÃ¡ la navegaciÃ³n
VersiÃ³n obtenida del pubspec: 1.0.11
  âœ… [FASE 4] 4.1 Login Estudiante (estu_77774309@test.com)
  âœ… [FASE 4] 4.2 Estudiante ve su dashboard
GET /estudiantes/me - Status: 200
  âœ… [FASE 4] 4.3 Estudiante ve su cÃ³digo QR
  âœ… [FASE 4] 4.4 Estudiante ve historial de asistencia (Materia: âœ—, Presente: âœ“)
    ğŸ“± [NOTIFICACIONES] Verificando secciÃ³n de notificaciones del estudiante...
  âœ… [FASE 4] 4.5 Verificar secciÃ³n notificaciones (NotificaciÃ³n de asistencia visible)
06:57 +0: loading C:/Proyectos/DemoLife/integration_test/main_e2e_test.dart
AppLifecycleManager: App resumed after 145s in background
AppLifecycleManager: Long background time, triggering data refresh
AppLifecycleManager: Triggering data refresh...
AppLifecycleManager: Refreshing data...
AppLifecycleManager: Token available, refreshing periodos...
PeriodoAcademicoProvider: Iniciando carga de perÃ­odos activos...
GET /periodos-academicos/activos - Status: 403
Error getting periodos activos: 403 - {"success":false,"error":"Acceso denegado: rol insuficiente","code":"AUTHORIZATION_ERROR"}
AppLifecycleManager: Periodos refreshed, refreshing grupos...
GrupoProvider: Iniciando carga de grupos...
GET /grupos - Status: 403
Error getting grupos: 403 - {"success":false,"error":"Acceso denegado: rol insuficiente","code":"AUTHORIZATION_ERROR"}
GrupoProvider: Estado cambiado a loaded
AppLifecycleManager: Grupos refreshed, refreshing materias...
GET /materias - Status: 403
Error getting materias: 403 - {"success":false,"error":"Acceso denegado: rol insuficiente","code":"AUTHORIZATION_ERROR"}
AppLifecycleManager: Materias refreshed, checking for horario refresh...
AppLifecycleManager: No selected group/period for horario refresh
AppLifecycleManager: Data refresh completed
07:02 +0: ğŸš€ FLUJO E2E TRANSACCIONAL - MICRO-UNIVERSO AISLADO
  âœ… [FASE 4] 4.6 Preferencias de notificaciÃ³n estudiante (Preferencias accesibles)
ğŸ“¤ POST /auth/logout
ğŸ“¡ HTTP 404 /auth/logout
AppConfig: No se pudo cargar .env: Instance of 'FileNotFoundError'
AppConfig: Rutas intentadas para .env (muestra hasta 30):
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\Debug\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\.env
  - C:\Proyectos\DemoLife\build\windows\x64\.env
  - C:\Proyectos\DemoLife\build\windows\.env
  - C:\Proyectos\DemoLife\build\.env
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\.env
  - C:\Proyectos\DemoLife\build\windows\x64\.env
  - C:\Proyectos\DemoLife\build\windows\.env
  - C:\Proyectos\DemoLife\build\.env
  - C:\Proyectos\DemoLife\.env
AppConfig: Usando configuraciÃ³n por defecto
  - API_BASE_URL: http://192.168.20.22:3000
  - ENVIRONMENT: development
  - Plataforma: windows
07:08 +0: loading C:/Proyectos/DemoLife/integration_test/main_e2e_test.dart
AppLifecycleManager: App paused at 2025-12-04 14:56:43.029188
07:16 +0: ğŸš€ FLUJO E2E TRANSACCIONAL - MICRO-UNIVERSO AISLADO
  âœ… [FASE 4] 4.7 Logout Estudiante

ğŸ“ FASE 5: PRUEBA ADICIONAL - MODO MANUAL

AuthService.login - URL: http://192.168.20.22:3000/auth/login
AuthService.login - Config Base URL: http://192.168.20.22:3000
ğŸ“¤ POST /auth/login
ğŸ“¡ HTTP 200 /auth/login
   Status: 200
   Body: {"success":true,"data":{"accessToken":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjZkNzlhYTI5LTU5ZTktNDBkYS1hMGM2LTdmZDJjNmY0YzEyNCIsInJvbCI6ImFkbWluX2luc3RpdHVjaW9uIiwiZW1haWwiOiJhZG1pbl83Nzc3NDMwOUB0ZXN0LmNvbSIsInRva2VuVmVyc2lvbiI6MSwiaWF0IjoxNzY0ODc4MjEzLCJleHAiOjE3NjQ5NjQ2MTN9.yQjKECxKYypV2DlSzcVB1OzQlH26skUKhqGi8PnRG0w","refreshToken":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjZkNzlhYTI5LTU5ZTktNDBkYS1hMGM2LTdmZDJjNmY0YzEyNCIsInJvbCI6ImFkbWluX2luc3RpdHVjaW9uIiwiZW1haWwiOiJhZG1pbl83Nzc3NDMwOUB0ZXN0LmNvbSIsInRva2VuVmVyc2lvbiI6MSwianRpIjoiOTgwMDk4M2QtMjU2MC00OTNkLWIyOGMtZjQ5NDU2NTU0YmIxIiwiaWF0IjoxNzY0ODc4MjEzLCJleHAiOjE3NjU0ODMwMTN9.sesa21OKnr9YHgKp5YeAqQbtuSoERP1d3RVa67aS0nU","expiresIn":24,"usuario":{"id":"6d79aa29-59e9-40da-a0c6-7fd2c6f4c124","nombres":"Admin 77774309","apellidos":"TestApellido","rol":"admin_institucion","instituciones":[{"id":"7b41749d-a98a-4d4d-984f-e7de3a841250","nombre":"Instituto 77774309","rolEnInstitucion":"admin"}]}}}
========================================
ğŸ“¤ GET /auth/institutions
ğŸ“¡ HTTP 200 /auth/institutions
InstituciÃ³n seleccionada automÃ¡ticamente: 7b41749d-a98a-4d4d-984f-e7de3a841250
Login exitoso, AuthWrapper manejarÃ¡ la navegaciÃ³n
UserProvider: Iniciando carga de usuarios por instituciÃ³n 7b41749d-a98a-4d4d-984f-e7de3a841250...
VersiÃ³n obtenida del pubspec: 1.0.11
GET /usuarios/institucion/7b41749d-a98a-4d4d-984f-e7de3a841250 - Status: 200
  âœ… [FASE 5] 5.1 Login Admin para configurar MANUAL (admin_77774309@test.com)
  âœ… [FASE 5] 5.1c Actualizar config via API (MANUAL_ONLY)
ğŸ“¤ POST /auth/logout
ğŸ“¡ HTTP 404 /auth/logout
AppConfig: No se pudo cargar .env: Instance of 'FileNotFoundError'
AppConfig: Rutas intentadas para .env (muestra hasta 30):
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\Debug\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\.env
  - C:\Proyectos\DemoLife\build\windows\x64\.env
  - C:\Proyectos\DemoLife\build\windows\.env
  - C:\Proyectos\DemoLife\build\.env
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\.env
  - C:\Proyectos\DemoLife\build\windows\x64\.env
  - C:\Proyectos\DemoLife\build\windows\.env
  - C:\Proyectos\DemoLife\build\.env
  - C:\Proyectos\DemoLife\.env
AppConfig: Usando configuraciÃ³n por defecto
  - API_BASE_URL: http://192.168.20.22:3000
  - ENVIRONMENT: development
  - Plataforma: windows
  âœ… [FASE 5] 5.1e Logout Admin
    ğŸ“¡ Registrando asistencia vÃ­a API (MANUAL_ONLY)...
    âš ï¸ API POST /asistencias/registrar-manual: 400 - {"success":false,"message":"El estudiante ya tiene registrada su asistencia para esta clase hoy","error":"ValidationError"}
    âš ï¸ Error al registrar asistencia vÃ­a API (MANUAL_ONLY)
AuthService.login - URL: http://192.168.20.22:3000/auth/login
AuthService.login - Config Base URL: http://192.168.20.22:3000
ğŸ“¤ POST /auth/login
ğŸ“¡ HTTP 200 /auth/login
   Status: 200
   Body: {"success":true,"data":{"accessToken":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjM2ZDU1ZjcwLTczNTQtNDYxYi1iM2NlLTY0OTkxYzlmYjVlMCIsInJvbCI6InByb2Zlc29yIiwiZW1haWwiOiJwcm9mZV83Nzc3NDMwOUB0ZXN0LmNvbSIsInRva2VuVmVyc2lvbiI6MSwiaWF0IjoxNzY0ODc4MjUxLCJleHAiOjE3NjQ5NjQ2NTF9.Ahp00t3tzj82z0ZayJxFbT1lR_fj7vwuSK4-AmXNOaE","refreshToken":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjM2ZDU1ZjcwLTczNTQtNDYxYi1iM2NlLTY0OTkxYzlmYjVlMCIsInJvbCI6InByb2Zlc29yIiwiZW1haWwiOiJwcm9mZV83Nzc3NDMwOUB0ZXN0LmNvbSIsInRva2VuVmVyc2lvbiI6MSwianRpIjoiYmY2NzY0MTQtMjFkOS00ZDVkLTlmMTgtZDU5M2MxMGNmNGYzIiwiaWF0IjoxNzY0ODc4MjUxLCJleHAiOjE3NjU0ODMwNTF9.KymgOXTz2agcwIQdU7g7tPSkp3MwL-tS7TbhyIloEwk","expiresIn":24,"usuario":{"id":"36d55f70-7354-461b-b3ce-64991c9fb5e0","nombres":"Profesor 77774309","apellidos":"TestProf","rol":"profesor","instituciones":[{"id":"7b41749d-a98a-4d4d-984f-e7de3a841250","nombre":"Instituto 77774309","rolEnInstitucion":"member"}]}}}
========================================
ğŸ“¤ GET /auth/institutions
ğŸ“¡ HTTP 200 /auth/institutions
InstituciÃ³n seleccionada automÃ¡ticamente: 7b41749d-a98a-4d4d-984f-e7de3a841250
Login exitoso, AuthWrapper manejarÃ¡ la navegaciÃ³n
HorarioProvider: Cargando clases del dÃ­a para el profesor...
VersiÃ³n obtenida del pubspec: 1.0.11
GET /profesores/dashboard/clases-hoy - Status: 200
HorarioProvider: Recibidas 1 clases del dÃ­a
  âœ… [FASE 5] 5.3 Login Profesor para enviar manualmente (profe_77774309@test.com)
    ğŸ” [MANUAL] Buscando clase por materia: Materia 77774309
    âš ï¸ [MANUAL] No se encontrÃ³ la clase ni por materia ni por grupo
    ğŸ” [MANUAL] Buscando botÃ³n de notificaciÃ³n manual...
    ğŸ“Š [MANUAL] BotÃ³n por tooltip: 0, por icono: 0
    âš ï¸ [MANUAL] BotÃ³n no encontrado. Entramos a clase: false
    ğŸ“‹ [MANUAL] Textos visibles: Materia âœ—, Grupo âœ—
  âŒ [FASE 5] 5.3 Ver botÃ³n manual visible (BotÃ³n not found (entered: false))
ğŸ“¤ POST /auth/logout
ğŸ“¡ HTTP 404 /auth/logout
AppConfig: No se pudo cargar .env: Instance of 'FileNotFoundError'
AppConfig: Rutas intentadas para .env (muestra hasta 30):
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\Debug\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\.env
  - C:\Proyectos\DemoLife\build\windows\x64\.env
  - C:\Proyectos\DemoLife\build\windows\.env
  - C:\Proyectos\DemoLife\build\.env
  - C:\Proyectos\DemoLife\.env
  - C:\Proyectos\DemoLife\build\windows\x64\runner\.env
  - C:\Proyectos\DemoLife\build\windows\x64\.env
  - C:\Proyectos\DemoLife\build\windows\.env
  - C:\Proyectos\DemoLife\build\.env
  - C:\Proyectos\DemoLife\.env
AppConfig: Usando configuraciÃ³n por defecto
  - API_BASE_URL: http://192.168.20.22:3000
  - ENVIRONMENT: development
  - Plataforma: windows
  âœ… [FASE 5] 5.3e Logout Profesor
  âœ… [FASE 5] 5.4 Obtener token admin para verificar logs
    ğŸ“‹ [MANUAL] Logs response: OK
    ğŸ“‹ [MANUAL] Encontrados 0 logs de notificaciÃ³n
  âŒ [FASE 5] 5.4 Verificar recepciÃ³n manual (API logs) (No hay log exitoso)

======================================================================
ğŸ“Š RESUMEN DEL TEST E2E - MICRO-UNIVERSO AISLADO
======================================================================
   Total de pasos: 46
   âœ… Pasados: 44
   âŒ Fallidos: 2
   ğŸ“ˆ Porcentaje: 95.7%

ğŸ” CREDENCIALES CAPTURADAS:
   â€¢ admin: wz8***
   â€¢ profesor: E(%***
   â€¢ estudiante: 6*n***

ğŸ“¦ DATOS CREADOS:
   â€¢ notificaciones_activas: true
   â€¢ canal_notificacion: WHATSAPP
   â€¢ modo_notificacion: MANUAL_ONLY
   â€¢ institucion: Instituto 77774309
   â€¢ admin_email: admin_77774309@test.com
   â€¢ admin_password: ***capturada***
   â€¢ profesor_email: profe_77774309@test.com
   â€¢ telefono_responsable: +573103816321
   â€¢ estudiante_email: estu_77774309@test.com
   â€¢ asistencia_tomada: true
   â€¢ asistencia_id: created
   â€¢ notificacion_disparada: true

ğŸ“± RESUMEN DE NOTIFICACIONES:
   â€¢ Notificaciones: âœ… Activas
   â€¢ Canal: WHATSAPP
   â€¢ Modo: MANUAL_ONLY
   â€¢ Disparo: âœ… Verificado

ğŸ“‹ Detalle de resultados:
   âœ… [FASE 1] 1.1 Login Super Admin
   âœ… [FASE 1] 1.2 Navegar a Instituciones
   âœ… [FASE 1] 1.3a SecciÃ³n Notificaciones visible
   âœ… [FASE 1] 1.3b Activar notificaciones
   âœ… [FASE 1] 1.3c Seleccionar canal WhatsApp
   âœ… [FASE 1] 1.3d Seleccionar modo InstantÃ¡neo
   âœ… [FASE 1] 1.3 Crear InstituciÃ³n (Instituto 77774309)
   âœ… [FASE 1] 1.4 Navegar a gestiÃ³n de usuarios
   âœ… [FASE 1] 1.5 Crear Admin InstituciÃ³n (admin_77774309@test.com)
   âœ… [FASE 1] 1.6 Logout Super Admin
   âœ… [FASE 2] 2.1 Login Admin (admin_77774309@test.com)
   âœ… [FASE 2] 2.2 Dashboard Admin visible
   âœ… [FASE 2] 2.3 Crear PerÃ­odo (Usando perÃ­odos existentes)
   âœ… [FASE 2] 2.4 Crear Materia (Usando materias existentes)
   âœ… [FASE 2] 2.5 Crear Profesor (profe_77774309@test.com)
   âœ… [FASE 2] 2.6 Crear Estudiante (estu_77774309@test.com)
   âœ… [FASE 2] 2.7 Crear Grupo (Usando grupos existentes)
   âœ… [FASE 2] 2.8 Acceder a Horarios (SecciÃ³n disponible)
   âœ… [FASE 2] 2.9 Verificar config notificaciones (Switch: âœ“, WhatsApp: âœ—, Instant: âœ—)
   âœ… [FASE 2] 2.10 Logout Admin
   âœ… [FASE 3] 3.A.1 Login Admin vÃ­a API (admin_77774309@test.com)
   âœ… [FASE 3] 3.A.2 Obtener estudiantes (50e851e0-18ce-473b-9f79-a328cf1f58c1)
   âœ… [FASE 3] 3.A.3 Obtener/Crear horarios (3829a486-2cca-4b3b-803d-ad721614b276)
   âœ… [FASE 3] 3.A.4 Registrar asistencia vÃ­a API (AUSENTE registrado - NotificaciÃ³n disparada)
   âœ… [FASE 3] 3.A.5 Espera de notificaciÃ³n (Canal: WHATSAPP, Modo: INSTANT)
   âœ… [FASE 3] 3.B.1 Login Profesor (profe_77774309@test.com)
   âœ… [FASE 3] 3.B.2 Profesor ve dashboard con clases
   âœ… [FASE 3] 3.B.3 Entrar a gestiÃ³n de asistencia (Ya registrada vÃ­a API)
   âœ… [FASE 3] 3.B.4 Verificar asistencia registrada (Estado AUSENTE visible)
   âœ… [FASE 3] 3.B.5 NotificaciÃ³n WhatsApp (Disparada a +573103816321)
   âœ… [FASE 3] 3.B.6 Logout Profesor
   âœ… [FASE 4] 4.1 Login Estudiante (estu_77774309@test.com)
   âœ… [FASE 4] 4.2 Estudiante ve su dashboard
   âœ… [FASE 4] 4.3 Estudiante ve su cÃ³digo QR
   âœ… [FASE 4] 4.4 Estudiante ve historial de asistencia (Materia: âœ—, Presente: âœ“)
   âœ… [FASE 4] 4.5 Verificar secciÃ³n notificaciones (NotificaciÃ³n de asistencia visible)
   âœ… [FASE 4] 4.6 Preferencias de notificaciÃ³n estudiante (Preferencias accesibles)
   âœ… [FASE 4] 4.7 Logout Estudiante
   âœ… [FASE 5] 5.1 Login Admin para configurar MANUAL (admin_77774309@test.com)
   âœ… [FASE 5] 5.1c Actualizar config via API (MANUAL_ONLY)
   âœ… [FASE 5] 5.1e Logout Admin
   âœ… [FASE 5] 5.3 Login Profesor para enviar manualmente (profe_77774309@test.com)
   âŒ [FASE 5] 5.3 Ver botÃ³n manual visible (BotÃ³n not found (entered: false))
   âœ… [FASE 5] 5.3e Logout Profesor
   âœ… [FASE 5] 5.4 Obtener token admin para verificar logs
   âŒ [FASE 5] 5.4 Verificar recepciÃ³n manual (API logs) (No hay log exitoso)
======================================================================


âš ï¸ FLUJO COMPLETADO CON 2 PASOS FALLIDOS
   ğŸ“‹ Revisar los pasos marcados con âŒ arriba
â•â•â•¡ EXCEPTION CAUGHT BY FLUTTER TEST FRAMEWORK â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
The following TestFailure was thrown running a test:
Expected: <0>
  Actual: <2>
El micro-universo debe completarse al 100% sin fallbacks

When the exception was thrown, this was the stack:
#4      main.<anonymous closure> (file:///C:/Proyectos/DemoLife/integration_test/main_e2e_test.dart:2621:5)
<asynchronous suspension>
#5      testWidgets.<anonymous closure>.<anonymous closure> (package:flutter_test/src/widget_tester.dart:189:15)
<asynchronous suspension>
#6      TestWidgetsFlutterBinding._runTestBody (package:flutter_test/src/binding.dart:1027:5)
<asynchronous suspension>
<asynchronous suspension>
(elided one frame from package:stack_trace)

This was caught by the test expectation on the following line:
  file:///C:/Proyectos/DemoLife/integration_test/main_e2e_test.dart line 2621
The test description was:
  ğŸš€ FLUJO E2E TRANSACCIONAL - MICRO-UNIVERSO AISLADO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
08:46 +0 -1: ğŸš€ FLUJO E2E TRANSACCIONAL - MICRO-UNIVERSO AISLADO [E]
  Test failed. See exception logs above.
  The test description was: ğŸš€ FLUJO E2E TRANSACCIONAL - MICRO-UNIVERSO AISLADO
  
08:46 +0 -1: (tearDownAll)
08:46 +0 -1: Some tests failed.
